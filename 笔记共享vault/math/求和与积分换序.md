---
tags:
  - math
---

> [!核心想法]
> 1. 如果我们有一个求和/积分问题，比如$\sum X$而这个和/积分是难以处理的
> 2. 此时我们又发现我们可以把$X$写成一个新的求和或者积分，$X=\sum Y$或者$X =\int Y$那么此时我们得到了:
> $$\sum \sum Y \text{ or }\sum \int Y$$
> 3. 交换二者的次序，试试看交换以后的结果会不会更好。

下面是一个简单但又很经典的例子:

> [!矩阵trace的可交换性]
> $A=(a_{ij}),B=(b_{ij})$分别为两个n阶方阵那么他们的迹有关系:
> $$\text{Tr}(AB) = \text{Tr}(BA)$$

其证明如下：
$$\begin{aligned}\text{Tr}(AB) &= \sum_{i}(AB)_{ii} \\ &= \sum_i\sum_jA_{ij}B_{ji} \text{ 交换次序 }\\&=\sum_j\sum_iB_{ji}A_{ij} \\&= \sum_j (BA)_{jj} = \text{Tr}(BA)\end{aligned}$$
其中关键的一点是第一步，我们把$(AB)_{ii}$展开为了一个新的求和。

### 1. 求和换序的例子

* [[离散分部求和法]]实际上是求和换序的一个特例。
我们先从一个简单的例子开始。

求$\sum_{k=1}^{n}k2^k$,这个问题当中一种观点是可以把$k$视为是一个求和，然后交换$$\begin{aligned}\sum_{k\leq n}k2^k&=\sum_{k\leq n}2^k\sum_{i\leq k}1 \\ &=\sum_{i\leq n}\sum_{k\leq n}2^k\chi_{i\leq k} \\ &= \sum_{i\leq n}\sum_{i\leq k\leq n}2^k \\ &= \sum_{i\leq n} \left(2^{n+1}-2^{i}\right) \\ &=n2^{n+1}-2^{n+1}+2 \end{aligned}$$
这根本上是分部求和法。我们不妨把上述过程给一般化，假设我们要求$A_n = \sum_{k\leq n} a_k b_k$,然后假设$b_n$的前n项和为$S_n$,然后假设$a_k = \sum_{i\leq k} c_i$,于是我们重复上述过程:
$$\begin{aligned}\sum_{k\leq n}a_kb_k&=\sum_{k\leq n}b_k\sum_{i\leq k}c_i \\ &=\sum_{i\leq n}\sum_{k\leq n}c_ib_k\chi_{i\leq k} \\ &= \sum_{i\leq n}c_i\sum_{i\leq k\leq n}b_k \\ &= \sum_{i\leq n}c_i \left(S_n-S_{i-1}\right) \\ &=a_nS_{n}-\sum_{i\leq n}c_iS_{i-1} \\ &= a_nS_{n}-\sum_{i\leq n-1}c_{i+1}S_{i}\end{aligned}$$其中我们能看到$c_{i+1}$是$a_{i+1}-a_i$也就是差分，$S_i$是$b_i$的前n项和，因此这本质上就是分部求和法。
* [[利用求和换序解决几个数论中求和问题]] 这三个问题都可以归类为，$\sum_{k=1}^{n} f(k)\lfloor \frac{n}{k} \rfloor$的问题，而我们又想到可以展开$\left\lfloor\frac{n}{k} \right\rfloor = \sum_{m=1}^{n}\chi_{k|m}(m)$于是这就变成了一个双重求和的问题，交换次序以后变成了$\sum_{m=1}^{n} \sum_{k|m} f(k)$而内层的求和并不困难，因为$f$都是常见的数论函数，其Dirichlet卷积也都是简单的结果。于是整个求和过程被大大简化了。
* [[交换求和次序在解析数论当中的一个常用处理技巧]] 此笔记中阐述了交换求和次序在数论当中的另一种用法，即估计$\sum_{a,b;\text{cond}}f(a,b)=\sum_{a,b}f(a,b)\chi_{\text{cond}}(a,b)$这样的求和。此处的问题在于求和当中有一个条件cond，因为这个条件的存在导致此求和不能被直接估计。而解决的办法就是把此条件写成一个判断函数，然后想办法把判断函数展开为一个新的求和。然后通过交换次序，简化原来的求和。
* [[通过重整来证明表达式的非负性]]当中有这样一个例子，$$\sum_{1\leq i,j\leq
n}\left(\log(1+a_ia_j)-\log(1-a_ia_j)\right) \geq
0$$为了证明此对象非负，我们展开了被求和的对象为级数，然后交换了次序从而得到$\sum_{k\geq 1} \frac{1+(-1)^{k-1}}{k}\sum_{1\leq i,j\leq n}(a_ia_j)^{k}$，于是便证明了非负性。这里注意到双重求和，特别是求和下标范围完全一致的双重求和，对求和对象为对称的两个元素乘积的形式(比如此处的$a_ia_j$)很敏感，因为这意味着非负。



### 2. 积分与求和换序
这一类问题主要表现就是把积分转换为求和问题。也就是说$$\int X = \int \sum Y = \sum \int Y$$
* 这通常在处理一些积分问题当中有效果。当我们发现一个积分不好处理的时候，想着把被积分的函数展开为一个求和，然后通过交换积分与求和的次序把积分问题转换为求和问题。当然如果最后的和是更为简单的，那么自然这个尝试就是有效的。具体内容可以参考[[将积分转换为级数]]
### 3.求和与积分换序
顾名思义，也就是当我们在处理求和问题的时候发现不容易处理，于是考虑把被求和的一部分考虑为某个函数的积分，然后交换积分与求和的次序，看看是否能简化问题。

* 这其中一个经典的处理方法是，当我们需要证明某个双重求和的$\sum \sum X$我们通过把被求和对象改写为一个$\int Y_1Y_2$的形式那么原来的求和便成为了$$\sum\sum\int Y_1 Y_2 = \int\sum\sum Y_1Y_2 = \int(\sum Y_1)^2\geq 0$$在[[通过重整来证明表达式的非负性]]当中例如$\sum_{1\leq i,j\leq n}\frac{a_ia_j}{i+j-1} \geq 0$这个问题，我们把被求和的其中一部分$$\frac{1}{i+j-1}=\int_{0}^{1} x^{i-1}x^{j-1}\,dx $$做了处理，从而可以做到上面的操作，从而证明非负性。再比如此笔记中的另外一个问题，$$\sum_{1\leq i,j\leq n} \min(r_i,r_j)x_ix_j \geq 0$$处理方法是展开$\min(r_i,r_j) =\int_{0}^{\infty} \mathbf{1}_{t\leq r_i}(t)\mathbf{1}_{t\leq r_j}(t)\,dt$于是也可以进行上面的操作。再比如此笔记当中的$\sum_{1\leq i,j\leq n}|x_i+x_j|-|x_i-x_j|$问题,我们通过$$|x_i+x_j|-|x_i-x_j|=\frac{2}{\pi}\int_{0}^{\infty} \sum_{1\leq i,j\leq n}\frac{\sin(x_it)\sin(x_j t)}{t}\,dt $$完成此操作。

### 4. 积分换序


