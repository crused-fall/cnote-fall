---
tags:
  - math
  - 微积分
  - 大学数学竞赛
---

> [!问题1，CMC 2024]
> 证明$$\sum_{n\geq 1}\sum_{k\geq 1}\frac{(-1)^{\lfloor\sqrt{n}\rfloor}}{n^2+k^2}$$是收敛的。

整个问题我们可以看成是$$a_n:=\sum_{k\geq 1}\frac{(-1)^{\lfloor\sqrt{n}\rfloor}}{n^2+k^2}$$因为$a_n$对应的级数是绝对收敛的，所以这个定义是没有问题的。然后我们问，$\sum_{n\geq 1}a_n$是否是收敛的。

关于$a_n$我们发现当参数$n$固定下来的时候，还算是一个比较简单的形式:$$a_n:=(-1)^{\lfloor\sqrt{n}\rfloor}\sum_{k\geq 1}\frac{1}{n^2+k^2}$$所以关键是要搞清楚$b_n:=\sum_{k\geq 1}\frac{1}{n^2+k^2}$这个含参数的级数是什么。
* 我们一定要得到这个含参数的级数的closed form的表达吗？
不需要，因为我们最终的目的只是判断，$\sum_n (-1)^{\lfloor\sqrt{n}\rfloor}b_n$是否收敛，而此处$b_n$是单调减少到0的，因此我们只需要搞清楚$b_n$衰减得有多快。按照[[分部求和的想法，Dirichlet-Abel收敛判别法的推广]]当中例子3的结果，以及[[基于分部求和法的和的估计]]当中的想法，如果我们假设$A_N:=\sum_{n\leq N}(-1)^{\lfloor\sqrt{n}\rfloor}$，我们最后要估计的和$S_N:=\sum_{n\leq N} (-1)^{\lfloor\sqrt{n}\rfloor}b_n$等价于估计和$$b_NA_N+\sum_{n=1}^{N-1} A_n(b_n-b_{n+1})$$由于$b_n$从上单调收敛到0，因此我们真正关心的是$$T_N:=\sum_{n=1}^{N-1} |A_n|(b_n-b_{n+1})$$是否是$O(1)$的部分和。而这取决于$b_n$的衰减速度，由于$A_N=O(\sqrt{N})$的估计，那么$T_N$要想有界必须保证$$b_n\stackrel{?}{=}O\left(\frac{1}{n^{\frac{1}{2}+\varepsilon_0}}\right),\text{for some }\varepsilon_0>0$$于是我们并不需要得到准确的$b_n$的表达式，我们只需要得到其衰减速度即可。也就是说超过$\frac{1}{n^{\frac{1}{2}+\varepsilon_0}}$衰减的项的误差我们都是可以忽略的。所以这个问题总归还是一个估计问题，而不是求级数的closed form表达式的问题。

搞清楚这一点以后，我们就会直接考虑$$b_{n,N}:=\sum_{k\leq N}\frac{1}{n^2+k^2}$$二者之间的关系是$\lim_{N\to \infty}b_{n,N}=b_n$。对于此，我们发现被求和对象是单调减少的，并且被求和函数$\frac{1}{n^2+x^2}$的积分还算是简单的，因此可以考虑“简单积分估计”，参考[[和的积分估计]]。

于是$$\begin{aligned}b_{n,N}&=\sum_{k\leq N}\frac{1}{n^2+k^2}\\&=\int_{1}^N \frac{1}{n^2+x^2}\,dx+O\left(\frac{1}{n^2+1}+\frac{1}{n^2+N^2}\right)\\&=\frac{1}{n}\arctan\left(\frac{N}{n}\right)-\frac{1}{n}\arctan\left(\frac{1}{n}\right) +O\left(\frac{1}{n^2}\right)\end{aligned}$$
于是对$N$取极限，我们得到$$\begin{aligned}b_n&=\frac{\pi}{2n}-\frac{1}{n}\arctan\left(\frac{1}{n}\right) +O\left(\frac{1}{n^2}\right)\\&=O\left(\frac{1}{n}\right)\end{aligned}$$这是能满足我们要求的结果。因此级数$$\sum_{n\geq 1}\sum_{k\geq 1}\frac{(-1)^{\lfloor\sqrt{n}\rfloor}}{n^2+k^2}=\sum_{n\geq 1} (-1)^{\lfloor\sqrt{n}\rfloor}b_n$$是一个收敛的级数。