---
tags:
  - math
  - 组合学
  - 概率论
  - 中学数学竞赛
---
### 1. 竞赛问题

> [!CMO 1986,p3]
> $z_1,\cdots,z_n$是复平面上的n个复数，满足约束条件$$|z_1|+\cdots+|z_n|=1$$证明这些复数当中存在一个子列满足$$\left|\sum_{k\in S\subseteq \{1,\cdots,n\}}z_k\right|\geq \frac{1}{6}$$

首先，无论我们用什么方法证明存在性问题，我们都必然要面对的一个问题是，如何放缩$|\sum_{k\in S\subseteq \{1,\cdots,n\}}z_k|$?

我们先来看一个“玩具模型”：

> [!问题1：玩具模型]
> 假设我们只知道两个平面向量的下面两个信息：
> 1. 两个向量$v,w$各自模长之和$$||v||+||w||=a$$
> 2. 两个向量的大致角度，比如二者都在第一象限内。
> 
> 现在我们需要给出$||v+w||$的下界估计，我们怎么做?

如果我们只知道这两个信息，我们可以利用向量的投影来给出和的模长的下界估计，如图所示:

![[已知向量大致位置和模长和如何估计和的模长下界.png]]

我们可以把两个向量$w,v$向第一象限的角平分线方向的单位向量$u$做投影，因为向量本身的模长不会比任何方向的投影更小，此外两个向量都在第一象限，投影都是正的。此外，投影的夹角我们虽然不能完全确定，但是一定是小于等于$\frac{\pi}{4}$的，于是$$\begin{aligned}||w+v||&\geq 
\langle w+v,u\rangle \\ &= 
\langle w,u\rangle+ \langle v,u\rangle \\ &\geq ||w|| \cos(\pi/4)+||v||\cos(\pi/4)\\&= \frac{\sqrt{2}}{2}a\end{aligned}$$
所以根据这个“玩具模型”，我们尝试把它推广为一个能解决“CMO 1986,p3”的计划。

* 我们需要线性向量角度的范围，以使得最后可以对内积进行放缩。
* 我们还需要使得在这个范围内的向量与某个固定方向的单位向量$u$的投影是同号的。因为上面的“玩具模型”当中，实际上是$$||w+v||\geq 
|\langle w+v,u\rangle|$$然后因为两个向量到u的投影都是正的，因此可以直接打开。

那么我们不妨把一整个圆等分为三个部分。我们把$n$个复数看成是n个二维向量$v_1,\cdots,v_n$，因为它们的模长和为$1$，那么至少有一个$2\pi/3$的部分当中包含的所有向量，它们的模长和大于等于$1/3$。

![[把一个圆三等分.png]]

假设这些向量的指标对应的集合为$S \subset \{1,\cdots,n\}$，那么实际上这个$S$就是符合问题要求的子集$S$，即$$||\sum_{k\in S}v_k||\geq \frac{1}{6}$$
如图所示，我们考虑把所有$v_k,k\in S$当中的向量往单位向量$u$上做投影，此处$u$（图中红色的向量）是$v_k$所在的弧长$2\pi/3$的扇形区域的角平分线上的向量，因此任意$v_k,k\in S$与$u$的夹角不会超过$\pi/3$。于是有下面的放缩:

$$\begin{aligned}||\sum_{k\in S}v_k||&\geq 
\left\langle \sum_{k\in S}v_k,u\right\rangle \\ &= 
\sum_{k\in S}\langle v_k,u\rangle \\ &\geq \sum_{k\in S}||v_k||\cos(\pi/3)\\&= \frac{1}{2}\sum_{k\in S}||v_k||\\ &\geq \frac{1}{6} \end{aligned}$$


### 2. 推广

#### 2.1 下界还能更好吗？

> [!命题2.1 :CMO 1986,p3的优化]
> $z_1,\cdots,z_n$是复平面上的n个复数，满足约束条件$$|z_1|+\cdots+|z_n|=1$$证明这些复数当中存在一个子列满足$$|\sum_{k\in S\subseteq \{1,\cdots,n\}}z_k|\geq \frac{\sqrt{2}}{8}$$

在第一节的计划当中，我们除了可以把圆三等分，不可以四等分吗？我们来审视一下这个想法：
1. 四等分相当于看四个象限，一定存在一个象限当中的所有$v_k\geq 1/4$。
2. 如果我们把这个象限当中的所有向量对应下标$S$视为最终的结果，实际上下界不是变得更好了而是更差了。因为此时如果我们把这个象限当中的所有向量投影到角平分线上的单位向量$u$上，那么所有该象限当中的向量与$u$的夹角不会超过$\pi/4$。

于是$$\begin{aligned}||\sum_{k\in S}v_k||&\geq 
\left\langle \sum_{k\in S}v_k,u\right\rangle \\ &= 
\sum_{k\in S}\langle v_k,u\rangle \\ &\geq \sum_{k\in S}||v_k||\cos(\pi/4)\\&= \frac{\sqrt{2}}{2}\sum_{k\in S}||v_k||\\ &\geq \frac{\sqrt{2}}{8} \end{aligned}$$最后的结果$\frac{\sqrt{2}}{8}>\frac{1}{6}$的确是优化了下界的结果。

还能更好吗？如果我们继续沿用这个思路做下去，很快就会走到尽头，因为我们的下界无非就是$$L_n:=\frac{1}{n}\cos(\pi/n)$$我们可以证明这个序列在取正整数的时候，就是$L_4$最大，然后就会不断下降。

那么这个idea彻底山穷水尽了吗？

#### 2.2 最好的下界是什么?

> [!定理2.2：继续优化]
> $z_1,\cdots,z_n$是复平面上的n个复数，满足约束条件$$|z_1|+\cdots+|z_n|=1$$那么这些复数当中存在一个子列满足$$\left|\sum_{k\in S\subseteq \{1,\cdots,n\}}z_k\right|\geq \frac{1}{\pi}$$

一定要等分吗？一定要选角平分线上的单位向量吗？如果我随机选一个方向上的单位向量$u$，然后统计所有的投影到$u$为正的$v_k$，下界会是多少?（实际上随机的测试告诉我们，随机选一个然后做投影，往往有时候这样得到的下界都要比上面等分的更好）

本身这也是一个组合风格的存在性问题，我们联想到[[通过求期望证明具有某种性质的结构的存在性]]的想法，因此现在我们想到可以构建一个概率模型，然后考虑其期望是多少。

我们假设$\theta\sim U[0,2\pi)$是一个均匀分布的随机变量，然后考虑一个单位向量$$u_{\theta}:=(\cos(\theta),\sin(\theta))$$于是我们考虑所有与$u_{\theta}$内积为正的$v_k$对应的下标为$S_{\theta}$，它们的和定义为随机的向量$$v_{\theta}:=\sum_{k\in S_{\theta}} v_k$$这样我们可以得到一个随机变量$||v_{\theta}||$,我们现在关心它的期望的下界估计。因为如果$$\mathbb{E}(||v_{\theta}||)\geq \frac{1}{\pi}$$那么一定会存在某个$\theta_0$，对应一个确定的集合$S_{\theta_0}\subset \{1,\cdots,n\}$使得$$||v_{\theta_0}||:=||\sum_{k\in S_{\theta_0}} v_k|| \geq \frac{1}{\pi}$$
那么估计$\mathbb{E}(||v_{\theta}||)$的方法来源于之前的分析，$$\begin{aligned}\mathbb{E}(||v_{\theta}||)&\geq \mathbb{E}\left(\sum_{k\in S_{\theta}}\langle v_k,u_{\theta}\rangle\right) \\ &=\mathbb{E}\left(\sum_{k\in S_{\theta}}||v_k||\cos(\theta_k-\theta)\right) \\ &= \mathbb{E}\left(\sum_{k=1}^n||v_k||\max\{0,\cos(\theta_k-\theta)\}\right) \\&=\sum_{k=1}^n||v_k||\mathbb{E}(\max\{0,\cos(\theta_k-\theta)\})\\&= \frac{1}{\pi}\sum_{k=1}^n ||v_k||\\&= \frac{1}{\pi} \end{aligned}$$
* 而最后的计算是容易的，因为$\theta$是均匀分布的，因此$$\begin{aligned}\mathbb{E}(\max\{0,\cos(\theta_k-\theta)\}) &= \frac{1}{2\pi}\int_{0}^{2\pi}\max\{0,\cos(\theta_k-x)\}\,dx\\&= \frac{1}{\pi}\end{aligned}$$

于是命题2.2得到证明。


#### 2.3 高维推广也可以吗?

> [!定理2.3：高维推广]
> $v_1,\cdots,v_n$是$\mathbb{R}^d$上的n个向量，满足约束条件$$||v_1||+\cdots+||v_n||=1$$那么这些复数当中存在一个子列满足$$\left\|\sum_{k\in S\subseteq \{1,\cdots,n\}}v_k\right\|\geq \frac{\Gamma\left(\frac{d}{2}\right)}{2\sqrt{\pi}\Gamma\left(\frac{d+1}{2}\right)}$$

* 带入$d=2$我们就能发现，正好是前面2.2节当中的结果$\frac{1}{\pi}$。


```mathematica
generateVectorsSimple[n_, k_] := Module[{vectors, totalNorm},
  (*生成n个k维随机向量，分量服从标准正态分布*)
  vectors = 
   Table[RandomVariate[NormalDistribution[0, 1], k], {i, 1, n}];
  (*计算所有向量的模长之和*)totalNorm = Total[Norm /@ vectors];
  vectors/totalNorm]

(*定义函数：输入向量列表，返回正内积的平均值*)
averageOfPositiveInnerProducts[vectorData_] := 
 Module[{k, u, innerProducts, positiveInnerProducts},(*输入检查*)
  If[Length[vectorData] == 0 || ! MatrixQ[vectorData, NumericQ], 
   Return["Error: Invalid vector data."]];
  k = Length[vectorData[[1]]];
  (*生成均匀分布的k维单位向量u*)
  u = Normalize[RandomVariate[NormalDistribution[0,1], k]];
  (*计算所有向量与u的内积*)innerProducts = Dot[#, u] & /@ vectorData;
  (*筛选正内积*)positiveInnerProducts = Select[innerProducts, # > 0 &];
  Total[positiveInnerProducts]]

vectorData = generateVectorsSimple[10, 3];
m = 100000;
Table[averageOfPositiveInnerProducts[vectorData], {i, 1, m}] // Mean
```

