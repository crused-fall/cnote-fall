---
tags:
  - 数论
  - math
  - 中学数学竞赛
---

> [!问题1,IMO 1988,p6]
> 令$a,b$是两个正整数，并且满足$ab+1|a^2+b^2$，证明:$$\frac{a^2+b^2}{ab+1}$$是一个完全平方数。

我们可以通过Mathematica先验证一下这个结果：

```mathematica
Table[k = (a^2 + b^2)/(a*b + 1); 
   If[IntegerQ[k], k, Nothing], {a, 1, 1000}, {b, 1, 1000}] // 
  Flatten // DeleteDuplicates
```

结果显示，如果令$$k=\frac{a^2+b^2}{ab+1}$$那么在我们所试验的结果当中$k$的取值有:$$1,4,9,16,25,36,49,64,81,100$$尽管$k$不尽相同，但是都为平方数。
### 1. Vieta Jumping

采用反证法。我们先固定一个正整数$k$考虑$k=\frac{a^2+b^2}{ab+1}$然后假设这样的$k$永远不是一个完全平方数。然后令$$A_k:=\left\{(a,b)\in \mathbb{Z}^+ \times \mathbb{Z}^+:k=\frac{a^2+b^2}{ab+1}\right\}$$假设$A_k$非空。
* 我们现在不考虑所有$k$的取值，而是限定满足整除条件的$(a,b)$等于一个固定的$k$。比如说，令$k=4$那么现在$(a,b)$的取值可能就有$(2,8),(8,30),(30,112),(112,418)$等等。我们固定$k$保持不变，也是为了方便我们接下来用Vieta定理的操作，方便我们控制变量。只要我们对任意固定的$k$都证明其不是完全平方数，那么自然命题成立。

如果我们现在考虑$f(x,y):=x+y$这样一个$A_k \to \mathbb{Z}^{+}$的二元函数，那么[[无穷递降]]当中的“命题1”告诉我们$A_k$当中必然存在一个元素$(a_0,b_0)$使得$a_0+b_0$使得$f(a_0,b_0)$取到最小值。

然后所谓Vieta Jumping发挥用处的地方就在于，利用$k=\frac{a^2_0+b^2_0}{a_0b_0+1}$并非平方数的假设，利用二次方程的维达定理去制造出一个$(a_1,b_1)\in A$并且$a_1+b_1<a_0+b_0$从而与我们关于$f(a_0,b_0)$最小的假设矛盾。

整理一下关于$k$的等式我们得到$$a_0^2+b_0^2-k(a_0b_0+1)=0$$不失一般性，假设$a_0\geq b_0$。现在如果我们把$a_0$替换为变量$x$，那么我们将会得到一个二次方程:$$x^2+(-kb_0)x+(b_0^2-k)=0$$那么由维达定理，我们可以知道:
1. $x_1+x_2=kb_0$
2. $x_1x_2=b^2_0-k$

不过我们已经知道这个方程的其中一个解一定是$a_0$,那么上述的维达定理就变成:
1. $x_2=kb_0-a_0$
2. $x_2=\frac{b^2_0-k}{a_0}$

> [!关键的想法]
> 此时我们意识到，如果我们能通过$k$的非平方数的假设得到:
> 1. $x_2>0$
> 2. $x_2<a_0$
> 
> 那么由于$(x_2,b_0) \in A_k$，这就导致$x_2+b_0<a_0+b_0$从而导出矛盾。所以接下来我们需要对$x_2$做上界和下界的估计。

首先维达定理里面的第一个式子告诉我们，$x_2$一定是一个整数。而维达定理第二点直接告诉我们，$x_2$不为0，因为$k$不是完全平方数。然后从方程中如果分离出$k$得到$$k_0=\frac{x_2^2+b_0^2}{x_2b_0+1}>0$$我们可以知道$x_2b_0>-1$,这意味着$x_2>0$，它是一个正整数。从而因为一开始的关于$a_0\geq b_0$的假设$$x_2=\frac{b^2_0-k}{a_0}<\frac{b_0^2}{a_0}\leq a_0$$这就意味着$x_2<a_0$。通过前面的分析我们知道$(x_2,b_0)\in A_k$但是$$x_2+b_0<a_0+b_0$$这与我们之前关于$(a_0,b_0)$的假设矛盾，于是关于$k$不为平方数的假设是错误的，于是$k$一定是一个平方数。
