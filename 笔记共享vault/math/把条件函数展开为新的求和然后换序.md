---
tags:
  - math
  - tool_idea
---

> [!把条件展开为求和]
> 当我们遇到形如$$\sum_{a,b;\text{cond}}f(a,b)
> =\sum_{a,b}f(a,b)1_{\text{cond}}(a,b)$$其中cond表示一个与$a,b$有关的一个条件。我们想到可以把$1_{\text{cond}}(a,b)$函数展开成一个求和的形式
> $$1_{\text{cond}}(a,b)=\sum_{c}g_c(a,b)$$这样展开以后，我们就得到一个双重求和:
> $$\begin{aligned}\sum_{a,b;\text{cond}}f(a,b) &=
> \sum_{a,b}f(a,b)1_{\text{cond}}(a,b) \\ &=
> \sum_{a,b}f(a,b)\sum_{c}g_c(a,b) =
> \sum_{a,b}\sum_{c}f(a,b)g_c(a,b) \\ &=
> \sum_{c}\sum_{a,b}f(a,b)g_c(a,b)\end{aligned}$$

### 1. 条件函数的Dirichlet卷积展开

> [!卷积法]
> 我们把被求和对象当中的一部分展开为更简单的函数的Dirichlet卷积的形式,然后交换求和次序，从而试图把对该数论函数的估计变成对更为熟悉且简单的数论函数的估计。

#### 1.1 卷积法的基本形式

> [!卷积法的常见形式1]
> 假设我们需要估计$F(x):=\sum_{n\leq x}f(n)$，其中$f(x)$是某个不好处理的算术函数。然而我们知道$$f=f_0*g$$其中$g$相对简单，而$f_0$的和$F_0(x):=\sum_{n\leq x}f_0(x)$的渐近结果是已知的。那么$$\begin{aligned}F(x)&=\sum_{n\leq x}f(n)=\sum_{n\leq x}\sum_{d|n}g(d)f_0(n/d)\\&=\sum_{n\leq x}\sum_{d\leq x}g(d)f_0(n/d)1_{d|n}=\sum_{d\leq x}\sum_{n\leq x}g(d)f_0(n/d)1_{d|n}\\&=\sum_{d\leq x}g(d)\sum_{q\leq x/d}f_0(q) \\&= \sum_{d\leq x}g(d)F_0(x/d)\end{aligned}$$这样问题就会变成我们熟悉的问题。

> [!卷积法的特殊形式1]
> 如果数论函数具有关系$$g=f*1$$那么根据“卷积法的常见形式1”，假设$F(x):=\sum_{n\leq x}f(n)$以及$\lfloor x\rfloor=\sum_{n\leq x}1$,于是$$\sum_{n\leq x}g(n)=\sum_{n\leq x}\sum_{d|n}f(d) = \sum_{n\leq x} F\left(\frac{x}{d}\right)=\sum_{n\leq x} f(n)\left\lfloor \frac{x}{n}\right\rfloor$$当然如果对最右边的形式做进一步估计,利用粗略的处理$\left\lfloor \frac{x}{n}\right\rfloor=\frac{x}{n}+O(1)$还会得到$$\sum_{n\leq x}g(n)=x\sum_{n\leq x} \frac{f(n)}{n}+O(F(x))$$


* [[对算术函数平均值的渐近]]:其中的"命题3.2"我们需要证明$$\left|\sum_{d \leq x}\frac{\mu(d)}{d}\right|\leq 1$$这个不等式可以用于改进$\sum_{n\leq x}\varphi(n)$的误差项到$O(x)$。证明的思路就是从Dirichlet卷积$$\mu*1=\varepsilon$$入手，然后利用“卷积法的特殊形式1”，从而得到$$1=\sum_{n\leq x}\mu(n)\left\lfloor\frac{x}{n}\right\rfloor$$于是我们最终只需要给出$f(x):=\sum_{n\leq x}\mu(n)\{\frac{x}{n}\}$的上界为$x-1$就能完成整个证明。
* [[正方形区域当中有多少个互素的整数格点]]:其本质就是要估计和$$S(N) =\frac{1}{N^2}\sum_{a,b\leq N;(a,b)=1}1$$其中条件函数$$\delta(n,1):=\begin{cases}1&n=1\\0&\text{otherwise}\end{cases}$$我们有办法把它转换为一个卷积的形式：$$\delta(n,1)=\mu*1$$于是通过卷积法，结合$$\sum_{d \leq N} \frac{\mu(d)}{d^2} =\frac{6}{\pi^2} + O\left( \frac{1}{N} \right)$$我们就可以得到最终的估计。
* [[简化一个数论求和]]：此问题是要简化和$$f(n):=\sum_{\begin{aligned}k\leq& n\\ (k,n)&=1\end{aligned}} \cos\left(\frac{2k\pi}{n}\right)$$其中的条件函数和上一个问题类似，用同样的方法可以简化得到$f=\mu$。
* [[前$N$个自然数当中，square-free的自然数的占比是多少]]：在这个问题中我们需要估计$$S(N)=\frac{1}{N}\sum_{n\leq N}g(n)$$其中$$g(n):= \begin{cases}1&\text{n is square-free}\\0&\text{otherwise}\end{cases}$$这个问题的关键是对函数$g$进行Dirichlet卷积的分解。不过这个函数并非是直接写成两个函数的卷积，而是说如果$n=m^2r$,其中$r$是square-free的，那么$g(n)=1*\mu(m)$也就是说$$g(n) = \sum_{ d^2|n} \mu(d)$$然后就是同样的方法可以得到结果。此外，该问题还可以推广为k-free的形式，方法类似。
* [[Wintner mean value theorem]]:在这个定理当中，我们已知算术函数$f=1*g$然后我们想要计算$f$的平均值$M(f)$。我们无非就是要估计和$S(x):=\frac{1}{x}\sum_{n\leq x}f(n)$精度要求至少是$o(1)$。因为$f=1*g$因此我们可以利用"Dirichlet 卷积法"，因为虽然我们至少知道常函数$1$的和的估计。最后为了保证余项$O\left(\frac{1}{x}\sum_{n\leq x}|g(n)|\right)$是$o(1)$的，因此我们可以假设条件级数$\sum_{n\geq 1}\frac{g(n)}{n}$绝对收敛，因为Kronecker的一个结果告诉我们，算术函数的$L$函数$L(s,f)$如果在某个$\text{Re}(s)>0$处有意义，那么算术函数的和$\sum_{n\leq x}f(n)=o(x^s)$。此处由于绝对收敛，因此$M(|g|)=0$，因此$O\left(\frac{1}{x}\sum_{n\leq x}|g(n)|\right)=o(x)$。

### 2. 把条件函数做傅里叶展开

### 2.1 roots of unity filter

这个方法也是处理求和的一个技巧，不过在当前的框架之下。因为它不过是对一种特定的条件
$$\mathbf{1}_{k|n}:=\begin{cases}1&k|n\\0&\text{otherwise}\end{cases}$$
的一种求和的表达方式而已。其本质是将函数在群$\mathbb{Z}/k\mathbb{Z}$上的傅里叶展开。详细参见，[[利用roots of unity filter求和]].



