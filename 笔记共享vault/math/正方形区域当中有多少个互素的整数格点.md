---
tags:
  - math
  - 数论
---
> [!问题1]
> $$S(N):=\frac{\#\{a,b\in\{1,...,N\}:(a,b)=1\}}{N^2}$$表示小于等于N的自然数对当中互素的对的密度，即互素的数对比上整体的比值。问题是，$S(N)$的渐近展开是怎样的?精确到$o(1)$。


我们可以把这个问题转换为一个和的估计的问题：$$S(N) =\frac{1}{N^2}\sum_{a,b\leq N;(a,b)=1}1$$

假设$n =(a,b)$，我们注意到$n=1$这个判断函数可以改写为$\delta(n,1)$的形式，$$\delta(n,1):=\begin{cases}1&n=1\\0&\text{otherwise}\end{cases}$$那么此时$$S(N) =\frac{1}{N^2}\sum_{a,b\leq N}\delta(n,1)$$
在算术函数当中，我们想到可以把这个东西展开为Dirichlet卷积和的形式:$$\delta(n,1) =\sum_{d|n}\mu(d)$$
于是我们想到可以利用[[把条件函数展开为新的求和然后换序]]当中的“卷积法”。于是上述求和可以转换为:$$\begin{aligned}S(N)
&= \frac{1}{N^2}\sum_{a,b\leq N;(a,b)=1}1 \\ &=
\frac{1}{N^2}\sum_{a,b\leq N}\delta((a,b),1)\\&=
\frac{1}{N^2}\sum_{a,b\leq N}\sum_{d|(a,b)}\mu(d) \\
 &=\frac{1}{N^2}\sum_{a,b\leq N}\sum_{d\leq
 N}\mu(d)\mathbf{1}_{d|(a,b)}(d) \text{
  ,这一步对换序很重要}\\&=\frac{1}{N^2}\sum_{d\leq
  N}\sum_{a,b\leq N}\mu(d)\mathbf{1}_{d|(a,b)}(d)
  =\frac{1}{N^2}\sum_{d\leq N}\mu(d)\sum_{a,b\leq
  N}\mathbf{1}_{d|(a,b)}(d)\\&= \frac{1}{N^2}\sum_{d\leq
 N}\mu(d)\sum_{a,b\leq N;d|(a,b)}1 \text{
  ,这个求和是否比原来的求和更简单?这很重要}\\ &=
  \frac{1}{N^2}\sum_{d\leq N}\mu(d)
 \left(\frac{N}{d}+O(1)\right)^2 \\&= \sum_{d\leq
  N}\frac{\mu(d)}{d^2}+O\left(\frac{1}{N}\sum_{d\leq N}
  \frac{1}{d}\right)\\&= \sum_{d\leq N}\frac{\mu(d)}{d^2} +
  O\left(\frac{\log(N)}{N}\right)\end{aligned}$$
* 这里$\sum_{a,b\leq N;d|(a,b)}1=\left(\frac{N}{d}+O(1)\right)^2$是因为，我们把求和下标的条件变成了，$a,b,d\leq N \text{ and } d|a \text{ and }d|b$那么原先的求和就可以改成$$\begin{aligned}\sum_{a,b,d\leq N} \mathbf{1}_{d|a}\mathbf{1}_{d|b}&=\left(\sum_{a,d\leq N}\mathbf{1}_{d|a}\right)\left(\sum_{b,d\leq N}\mathbf{1}_{d|a}\right) \\ &= \left(\sum_{a,d\leq N}\mathbf{1}_{d|a}\right)^2 \\ &= \left(\frac{N}{d}+O(1)\right)^2\end{aligned}$$
* 最后一步，我们可以通过一个已知的结果：$$\begin{aligned}
\sum_{d \leq N} \frac{\mu(d)}{d^2} 
&= \sum_{d \geq 1} \frac{\mu(d)}{d^2} - \sum_{d > \sqrt{N}} \frac{\mu(d)}{d^2} \\&= \frac{1}{\zeta(2)} + O\left( \sum_{d > N} \frac{1}{d^2} \right) \\&= \frac{6}{\pi^2} + O\left( \frac{1}{N} \right)
\end{aligned}$$
所以最后可以得到结论:$$S(N) =
 \frac{6}{\pi^2}+O\left(\frac{\log(N)}{N}\right)$$
* 类似的问题：[[简化一个数论求和]]