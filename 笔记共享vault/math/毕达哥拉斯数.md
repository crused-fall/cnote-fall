---
tags:
  - 代数基础
  - math
  - 数论
  - 中学数学竞赛
  - 初中数学
---

> [!定理1：Euclid,公元前]
> 假设整数$x,y,z$互素并且$x$是奇数$y$为偶数，那么存在整数$a,b$使得方程$$x^2+y^2=z^2$$的解可以表示为$$x=a^2-b^2,y=2ab,c=a^2+b^2$$

### 1. Coprime power trick 1

如果我们把$y$拿到方程的右边，那么我们可以通过平方差把原本的方程改写为$$x^2=(z-y)(z+y)$$于是我们想到[[利用因式分解求解丢番图方程]]的第二节中的coprime power trick在整数上的形式。考虑到$z-y,z+y$二者都是奇数，假设二者存在公因子$d$，那么必然有$$d|2z,2y$$那么由于$z,y$互素，于是$d|1$，所以$z-y,z+y$互素。于是coprime power trick告诉我们，现在可以对二者进行参数化处理,令$s,r$为两个奇数，并且满足$$z-y=r^2,z+y=s^2$$解这个方程组，于是得到$z=\frac{1}{2}\left(r^2+s^2\right),y=\frac{1}{2}\left(s^2-r^2\right)$于是$x=rs$。

现在如果我们换一个写法，令$a=\frac{s+r}{2},b=\frac{s-r}{2}$于是$$x=a^2-b^2,y=2ab,z=a^2+b^2$$
### 2. Coprime power trick 2

对于$x^2+y^2=z^2$这个方程，如果我们考虑直接在$\mathbb{Z}[i]$上分解方程的左边，那么我们就能得到
$$(x-iy)(x+iy)=z^2$$于是我们想到[[利用因式分解求解丢番图方程]]的第二节中的coprime power trick在UFD上的情形。由于$\mathbb{Z}[i]$是一个UFD（参考[[高斯整数的性质]]），那么只要我们能证明满足方程的$(x,y,z)$构成的$x-iy,x+iy$如果在$\mathbb{Z}[i]$当中互素，那么我们就可以对其进行参数化，令$$x-iy=u(a+ib)^2$$其中$u=i^k,k=0,1,2,3$是$\mathbb{Z}[i]$当中的单位元。如果我们固定$u=1$，那么我们会发现$$x=a^2-b^2,y=2ab,z=a^2+b^2$$当然我们如果选用其他的单位元$u$，会得到不同的$x,y$的表达，这取决于原本的毕达哥拉斯方程中$x,y$哪一个是奇数。

而此处之所以$x-iy,x+iy$互素是因为，假设$d|x-iy,x+iy$那么公因子必然整除于二者之和，于是$d|2x,2y$。如果$d|2,d\neq 1$，那么由于$d|z^2$,那么这与$z$是奇数的假设矛盾。于是只能是$d|x,y$，令$N(d)$是高斯整数$d$的模，于是$$N(d)|x^2,y^2$$即正整数$N(d)$是$x,y$的公因子，但是我们假设$\text{gcd}(x,y)=1$于是只能是$N(d)=1$，从而导致$d$必须是$\mathbb{Z}[i]$当中的单位元。

