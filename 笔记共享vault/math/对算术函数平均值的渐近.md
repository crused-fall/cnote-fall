---
tags:
  - math
  - 数论
---
算术函数的值在局部上可能表现为剧烈震荡：
![[divisor function plot.png]]

这种剧烈的震荡，使得我们想要用于简单的函数取近似这样的算术函数变得不现实，误差会大到整个渐近失去意义。但是函数值震荡剧烈不代表函数值的和函数也是剧烈震荡的，于是我们转而取求和函数的渐近结果。

下面是常见的算术函数和的渐近：

1. divisor function:$$\sum_{n\le x}d(n)=x\log(x)+(2\gamma-1)x+O(\sqrt{x})$$其中$\gamma$是欧拉常数。
2. divisor sum function:$$\sum_{n\leq x}\sigma_{a}(n)=\frac{\zeta(a+1)}{a+1}x^a+O(x^{b})$$其中$a>0,a\neq 1,b=\max\{1,a\}$
3. Euler totient function:$$\sum_{n\leq x}\varphi(n)=\frac{3}{\pi^2}x^2+O(x)$$
4. Mobius function:$$\sum_{n\leq x}\mu(n)=x+o(x)$$
5. Von Mangoldt function:$$\sum_{n\leq x}\Lambda(n)=x+o(x)$$
6. 整数$n$表示为平方和的种数，即定义$$r_2(n):=\#\{(x,y)\in \mathbb{Z}^2:n=x^2+y^2\}$$其和的估计为:$$\sum_{n\leq x}r_2(n)=\pi x+O(\sqrt{x})$$


### 1. divisor function和的渐近

#### 1.1 一个粗略的估计

因为被求和对象$d(n)$可以展开为Dirichlet卷积$$d=1*1$$于是参照[[把条件函数展开为新的求和然后换序]]当中的“卷积法的特殊形式1”，从而得到$$\sum_{n\le x}d(n)=\sum_{d\leq x}\left\lfloor\frac{x}{d}\right\rfloor$$
此时最简单的处理为，考虑$\left\lfloor\frac{x}{d}\right\rfloor=\frac{x}{d}+O(1)$于是$$\sum_{d\leq x}\left\lfloor\frac{x}{d}\right\rfloor=\sum_{d\leq x}\left(\frac{x}{d}+O(1)\right)=x\sum_{d\leq x}\frac{1}{d}+O(x)$$于是$$\sum_{n\leq x}d(n)=x\log(x)+O(x)$$
#### 1.2 用Dirichlet's hyperbola trick 改进误差

##### 1.2.1 方法的描述

***这是一种非常特殊的方法，并不通用。*** 此方法首先基于Dirichlet卷积法，假设$f=g*h$然后我们已知$g$的和$G(x):=\sum_{a\leq x} g(a)$的估计,以及$h$的和$H(x):=\sum_{a\leq x} h(a)$的估计，现在想要得到$F(x):=\sum_{a\leq x} f(a)$的估计。参照卷积法的思路，但是中间对和的处理不同$$\begin{aligned}F(x)=\sum_{n\leq x}f(n)&=\sum_{n\leq x}\sum_{d|n}g(d)h(n/d)\\&= \sum_{n\leq x}\sum_{qd=n}g(d)h(q)\\&= \sum_{\begin{aligned}q,d&\leq x\\qd&\leq x \end{aligned}}g(d)h(q)\end{aligned}$$此时的和$F(x)$相当于我们是在一个如下图的区域当中的所有整数格点上取二元函数值$g(d)h(q)$然后求和。

![[dirichlet hyperbola method figure.png]]
(图中我们把横轴设定为d,纵轴设定为q。中间蓝色正方形的区域是$q,d\leq \sqrt{x}$的部分)

我们可以把求和分为三个部分的组合，分别是$$\sum'=\sum_{d\leq \sqrt{x}}\sum_{q\leq x/d},\sum''=\sum_{q\leq \sqrt{x}}\sum_{d\leq x/q},\sum'''=\sum_{d\leq \sqrt{x}}\sum_{q\leq \sqrt{x}}$$于是根据图形的对称性,以及$\sum',\sum''$当中都包含了$\sum'''$当中的点，于是上图中所有整个格点的数目应该是$$\sum_{\begin{aligned}q,d&\leq x\\qd&\leq x \end{aligned}}1 = \sum'+\sum''-\sum'''$$那么当我们的数论函数$g(d)h(q)$在这样的区域上求和的时候，我们也可以做这样的估计,从而使得$$\begin{aligned}F(x)&= \sum_{\begin{aligned}q,d&\leq x\\qd&\leq x \end{aligned}}g(d)h(q)\\&= \sum_{d\leq \sqrt{x}}\sum_{q\leq x/d}g(d)h(q)+\sum_{q\leq \sqrt{x}}\sum_{d\leq x/q}g(d)h(q)-\sum_{d\leq \sqrt{x}}\sum_{q\leq \sqrt{x}}g(d)h(q) \\&=\sum_{d\leq \sqrt{x}}g(d)H(x/d)+ \sum_{q\leq \sqrt{x}}h(q)G(x/q)-G(\sqrt{x})H(\sqrt{x})\end{aligned}$$
##### 1.2.2 对divisor function 使用这样的技巧

因为$d=1*1$,于是对于1.2.1最后的公式当中，相当于$h(x)=g(x)=1$以及$H(x)=G(x)=\lfloor x\rfloor$。那么$$\begin{aligned}\sum_{n\leq x}d(n) &= \sum_{d \leq \sqrt{x}} \lfloor x/d\rfloor + \sum_{q \leq \sqrt{x}} \lfloor x/q\rfloor- \lfloor \sqrt{x}\rfloor^2 \\ &= 2x\sum_{d\leq \sqrt{x}}\frac{1}{d}+O(\sqrt{x})-(x+O(\sqrt{x}))\\&= 2x\left(\log(\sqrt{x})+\gamma+O\left(\frac{1}{\sqrt{x}}\right)\right)-x+O(\sqrt{x}) \\&= x\log(x)+2x(\gamma-1)+O(\sqrt{x})\end{aligned}$$
于是我们便得到了误差为$O(\sqrt{x})$的divisor function和的渐近。

### 2. Divisor sum function 

### 3. Euler's totient function 

#### 3.1 Dirichlet卷积法

主要想法为[[把条件函数展开为新的求和然后换序]]中的卷积法。考虑Dirichlet卷积$$\varphi=\mu*\text{id}$$
我们考虑到$\text{id}$的部分和是相对简单的，形式为$$\begin{aligned}F_0(x)&:=\sum_{k\leq x}\text{id}(k)=\frac{1}{2}\lfloor x \rfloor^2+\frac{1}{2}\lfloor x \rfloor\\&= \frac{1}{2}x^2+O(x)\end{aligned}$$于是参考“卷积法的常见形式1”，我们有：
$$\begin{aligned} \sum_{d\leq x} \varphi(d)&=\sum_{d\leq x}\mu(d)F_0(x/d)\\&= \frac{x^2}{2}\sum_{d \leq x}\frac{\mu(d)}{d^2}+O\left(x\sum_{d\leq x}\frac{\mu(d)}{d}\right)\\&= \frac{x^2}{2}\left(L(2,\mu)-\sum_{d>x}\frac{\mu(d)}{d^2}\right)+O(x\log(x))\\&= \frac{3}{\pi^2}x^2+O(x\log(x))\end{aligned}$$
* 余项的部分用的是比较粗略的估计，$$\left|\sum_{d\leq x}\frac{\mu(d)}{d}\right| \leq \sum_{d \leq x} \frac{1}{d} = O(\log(x))$$但实际上，后面的命题"3.2"告诉我们$$\left|\sum_{d\leq x}\frac{\mu(d)}{d}\right| \leq 1$$从而余项我们可以改进到$O(x)$。
* 然后是$\mu$的$L$函数$L(s,\mu)$在$s=2$处的渐近$$\sum_{d \leq x} \frac{\mu(d)}{d^2}=\frac{1}{\zeta(s)}+O(1/x)$$
#### 3.2 对$\mu$用卷积法，把误差改进到$O(x)$

主要的工作就是估计部分和$\sum_{d \leq x}\frac{\mu(d)}{d}$。

> [!命题3.2]
> $$\left|\sum_{d \leq x}\frac{\mu(d)}{d}\right|\leq 1$$当$x\geq 2$的时候，不等式是严格的。
* $1\leq x<2$的时候要求和的对象实际上就只有$\mu(1)=1$因此取到等于。
* 对于3.1节最后的结果，根据命题3.2，我们就可以把余项改进到$O(x)$，从而得到$$\sum_{n\leq x}\varphi(n)=\frac{3}{\pi^2}x^2+O(x)$$
证明的思路如下：

1. 首先我们知道Mobius函数的Dirichlet卷积的结果$$\mu*1=\varepsilon$$其中$\varepsilon(n)$是Dirichlet卷积的单位元。
2. 然后[[把条件函数展开为新的求和然后换序]]的"卷积法的特殊形式1"中的公式告诉我们$$\sum_{n\leq x}\varepsilon(n)=\sum_{n\leq x}\mu(n)\left\lfloor\frac{x}{n}\right\rfloor$$这个式子左边始终等于1，因为$\varepsilon(1)=1$如果$n\neq 1,\varepsilon(n)=0$。于是$$1=\sum_{n\leq x}\mu(n)\left\lfloor\frac{x}{n}\right\rfloor$$
3. 不过上面的等式与我们想要的结果还是有一定的差距的，由于$\left\lfloor\frac{x}{n}\right\rfloor=\frac{x}{n}-\{\frac{x}{n}\}$，然后带入上述式子当中，于是得到$$\sum_{n\leq x}\frac{\mu(n)}{n}=\frac{1}{x}\left(1+\sum_{n\leq x}\mu(n)\{\frac{x}{n}\}\right)$$所以我们只需要给$f(x):=\sum_{n\leq x}\mu(n)\{\frac{x}{n}\}$一个上界即可。一个非常粗糙的估计就是直接考虑三角不等式结合逐项放缩，因为$|\mu(n)\{\frac{x}{n}\}|<1$，从而得到$|f(x)| < \lfloor x \rfloor$不过“命题3.2”需要的是在$x\geq 2$的情况下，$|f(x)|<x-1$。这其实只需要考虑到，$\mu(n)$其中某一项为0即可，如此一来$f(x)$在不考虑这一项的基础上就有$$|f(x)|<\lfloor x\rfloor-1\leq x-1$$实际上，只要$x\geq 4$，$\mu(4)=0$，于是$f(x)$当中至少$n=4$这一项会消失，从而使得上述不等式成立。
4. 于是我们只需要验证对于$4> x\geq 2$的时候$|f(x)|<x-1$依旧成立，那么"命题3.2"也就得到了证明。这是容易验证的，我们只需要分别考虑$3>x\geq 2$的时候$\{x\}-\{x/2\}<x-1$以及$4>x\geq 3$的时候$\{x\}-\{x/2\}-\{x/3\}<x-1$即可，这是容易验证的。

### 6. $r_2(n)$的和的估计：Gauss's circle problem

按照定义:$$r_2(n):=\#\{(x,y)\in \mathbb{Z}^2:n=x^2+y^2\}$$
#### 6.1 上下极限

本文一开始便阐述了研究数论函数平均值的动机，即如果数论函数震荡剧烈，那么不可能有简单的渐近行为，但是其和有可能具有简单的渐近行为。那么$r_2(n)$震荡激烈吗？

> [!命题6.1]
> $$\liminf_{n\to \infty}r_2(n)=0,\limsup_{n\to \infty} r_2(n)=\infty$$

通过这个命题我们知道，其震荡的确激烈。这个命题是通过下面的已知结果来的：

> [!定理6.2:sum of two squares theorem]
> 整数$n$能被表示为两个整数的平方和，当且仅当其素因分解当中没有$p^k$形式的因子，其中$k$是奇数，$p$是模4余3的素数。

所以我们实际上可以构造出无穷多个使得$r_2(n)=0$的整数$n$，从而$r_2(n)$的下极限为0。

下面的这个结果可以视为是6.2的定量版本，先后由Gauss以及Jacobi用两种不同的方法证明。

> [!定理6.3:定量版本的 two square theorem(Gauss,Jacobi)]
> $d(n)$是divisor函数，$d_a(n)$是n的所有模4余a的因子的个数。假设$n=2^fn_1n_2$其中$$n_1=\prod_{p\equiv 1(\text{mod }4)}p^r,n_2=\prod_{q\equiv 3(\text{mod }4)}q^s$$那么:
> 1. $r_2(n)=0$当且仅当$n_2$当中某个$s$是奇数。
> 2. 如果所有的$s$都是偶数，那么$$r_2(n)=4d(n_1)=4(d(n)-d_3(n))$$

* 上述定理的第一个结论，证明可以参考[[模4余3的素数无法被表达为两个有理数的平方和]]中的"命题2.2"，此命题证明了$x^2+y^2=n$当$d_3(n)$为奇数的时候，方程没有有理解，因此自然也没有整数解。
* 由上述定理的第二个定量的结论，我们可以构造$n_2=5^n$,此时$n_2$可以认为所有模4余3的素因子的指数$s$都是$0$。于是按照上面的结果$$r_2(5^n)=4d(5^n)=4(n+1)$$于是我们知道$r_2(n)$序列的上极限为无穷大。

#### 6.2 $r_2(n)$的和函数的估计

令其和函数为$A(x):=\sum_{n\leq x}r_2(n)$，那么实际上$A(x)$是具有一定的几何意义的，其表示半径为$\sqrt{x}$的圆盘上的整数格点的个数问题。

对$A(x)$的第一个估计来自于高斯，其方法是完全从几何直观上出发的。如图所示：

![[高斯圆问题图示1.png]]

当我们考虑红色圆周里面的格点的数目，也就是图上蓝色的点加上黑色的圆心的总数的时候，我们可以考虑以这些点为中心的单位正方形的面积。这些单位正方形互相之间是没有重叠的，它们的面积总和就是单位正方形的数目，而这个数目又等于这些正方形的中心的个数。那么，所有的中心落在红色圆周上面以及内部的单位正方形面积总和就是$A(x)$的值。

如图所示，这些所有中心落在红色圆周内部以及边缘上的单位正方形，是被包含在绿色圆周里面，同时这些单位正方形又覆盖蓝色圆周。于是：
$$\pi\left(\sqrt{x}-\frac{\sqrt{2}}{2}\right)^2\leq A(x)\leq \pi\left(\sqrt{x}+\frac{\sqrt{2}}{2}\right)^2$$于是我们知道$$A(x)=\pi x+O(\sqrt{x})$$

#### 6.3 Gauss's Circle Conjecture

如果定义$E(x):=|A(x)-\pi x|$那么6.2的结果告诉我们$$E(x)=O(x^{1/2})$$
> [!Gauss's Circle Conjecture]
> $$E(x)=O(x^{\frac{1}{4}+\varepsilon}),\forall \varepsilon>0$$

* 当然如果令$x=r^2$，然后考虑$E'(r):=E(x^2)$即$x^2+y^2\leq r^2$当中的整数格点数目与$\pi r^2$的绝对误差的估计，那么猜想可以写成$$E'(r)=O(r^{\frac{1}{2}+\varepsilon}),\forall \varepsilon>0$$
