---
tags:
  - math
  - 数论
  - 中学数学竞赛
---
> [!问题1]
> $x,y$是两个正整数，并且满足$xy|x^2+y^2+1$证明$$x^2+y^2+1=3xy$$

我们首先可以用Mathematica来验证一下这个结果。

```mathematica
Table[k = (x^2 + y^2 + 1)/(x*y); 
   If[IntegerQ[k], k, Nothing], {x, 1, 1000}, {y, 1, 1000}] // 
  Flatten // DeleteDuplicates
```

结果我们发现，这100万个数据当中所有满足$xy|x^2+y^2+1$的情况无一例外都有$\frac{x^2+y^2+1}{xy}=3$。此外我们还发现，使得等式成立的最小的$(x,y)$为$x=y=1$。

### 1. Vieta Jumping的思路

固定$k$为一个正整数，然后考虑$$A_k:=\left\{(x,y)\in \mathbb{Z}^+ \times \mathbb{Z}^+:k=\frac{x^2+y^2+1}{xy}\right\}$$如果$A_k$非空，那么考虑$f(x,y):=x+y$这样一个定义在$A_k$上的有下界的整数值的函数，于是[[无穷递降]]中命题1告诉我们，函数存在最小值$x_0+y_0$。

此时我们讨论是否有$x_0=y_0$的问题。因为如果$x_0=y_0$，那么一定有$$x_0^2|2x_0^2+1$$从而导致$x_0|1$于是$x_0=y_0=1$，此时$k=3$。而又因为$\mathbb{Z}^2$当中所有满足$xy|x^2+y^2+1$的元素可以拆分为$A_k$的并，而如果$A_k$非空$(x_0,y_0) \in A_k$是使得$f$最小的元素，那么就得到$k=3$。因此就能证明整个“问题1”。

但是$x_0,y_0$就必须要相等吗？下面我们将采用Vieta Jumping来证明这件事。不失一般性假设$x_0>y_0、$，然后改写$k$的表达式，得到$$x_0^2-x_0(ky_0)+y_0^2+1=0$$
* 原本的问题当中$x,y$的位置是可以互换的。如果$(x,y)\in A_k$那么$(y,x)\in A_k$。并且当我们考虑函数$f$的最小值的时候，如果函数在$(x_0,y_0)$取到最小值，那么也一定在$(y_0,x_0)$上取到最小值。所以当我们所不失一般性假设$x_0>y_0$的时候，我们实际上就选择两个都能取到最小值的点当中第一个分量更大的那个点。

此式子对应到一个二次方程$$t^2-(ky_0)t+y_0^2+1=0$$由Vieta定理，我们得到:
1. $t_1+t_2=ky_0$
2. $t_1t_2=y_0^2+1$

由于我们已经知道其中一个解为$t_1=x_0$，于是:
1. $t_2=ky_0-x_0$
2. $t_2=\frac{y_0^2+1}{x_0}$
然后我们现在需要估计$t_2$。因为$(t_2,y_0)$也是$A_k$当中的元素，倘若$t_2<x_0$，那么$t_2+y_0<x_0+y_0$就会与$x_0,y_0$的假设矛盾。

由于$1\leq y_0<x_0$而二者皆为整数，那么至少$x_0\geq 2,y_0+1\leq x_0$,于是$$t_2\leq \frac{(x_0-1)^2+1}{x_0}=x_0+\frac{2}{x_0}-2\leq x_0-1$$因此$t_2<x_0$。于是由以上分析，我们知道我们最初的假设是错误的，正确的结果应该是$x_0=y_0$。于是结合前面的分析，我们便解决了整个问题。


