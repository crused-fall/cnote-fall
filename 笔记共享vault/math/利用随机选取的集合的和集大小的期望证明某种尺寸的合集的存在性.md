---
tags:
  - math
  - 组合学
  - 概率论
  - 中学数学竞赛
---

> [!IMO shortlist 1999,C4]
> 证明对于任意$A\subset \mathbb{Z}_{N^2}$并且$|A|=N$的集合，都存在一个集合$B\subset \mathbb{Z}_{N^2}$并且$|B|=N$使得$$|A+B|> \frac{N^2}{2}$$其中$A+B:=\{a+b:a\in A,b\in B\}$。

我们想到证明某种情况的存在性，但是不需要知道这种情况具体的信息，我们可以让整个事情随机化，然后计算其期望。（参考[[通过求期望证明具有某种性质的结构的存在性]]）

这部分分解随机变量的思路，参考[[通过求期望证明具有某种性质的结构的存在性]]当中的1.2节。

我们先来想一想，我们要如何计算$|A+B|$？

最朴素的方法就是一个个判断，即对于任意$c\in \mathbb{Z}_{N^2}$,判断是否$c\in A+B$，如果是则记为1，否则不做任何操作。最后在我们遍历了整个$\mathbb{Z}_{N^2}$以后，看看最后计数的总和是多少。也就是说$$|A+B|=\sum_{c\in \mathbb{Z}_{N^2}}f_B(c)$$其中$$f_B(c):=\begin{cases}1&c \in A+B\\ 0& \text{otherwise}\end{cases}$$那么在考虑随机变量的时候，我们可以先从这个函数开始入手构造。令$P_N$是$\mathbb{Z}_{N^2}$的所有$N$个元素组的子集的集合,那么$|P_N|=\binom{N^2}{N}$。$X_c(B)$是从$P_N$到$\{0,1\}$的随机变量，定义为$$X_c(B):=\begin{cases}1&c \in A+B\\ 0& \text{otherwise}\end{cases}$$其中$$\mathbb{P}(X_c=0)=\frac{\binom{N^2-N}{N}}{\binom{N^2}{N}}=\prod_{k=1}^N \left(1-\frac{N}{N^2-N+k}\right)$$这样设置是因为，这就是我们此上下文中认为的“均匀”。因为$X_c(B)=0$意味着，对任意的$a_i+b\neq c$也就是$b\neq c-a_i$,其中$c-a_1,\cdots c-a_N$是$\mathbb{Z}_{N^2}$中$N$个不同的元素，而我们的$B$当中不能包含其中的任何一个，剩下可选的元素一共有$N^2-N$个，而我们认为每种情况都是一样的，因此概率定义为$\mathbb{P}(X_c=0)=\frac{\binom{N^2-N}{N}}{\binom{N^2}{N}}$,而自然剩下的部分定义为$\mathbb{P}(X_c=1)=1-\frac{\binom{N^2-N}{N}}{\binom{N^2}{N}}$。

于是我们可以定义随机变量$$X(B):=|A+B|=\sum_{c\in \mathbb{Z}_{N^2}}X_c(B)$$这是一个从$P_N$到正整数的随机变量。现在我们来计算其期望$$\begin{aligned}\mathbb{E}(X)&=\sum_{c\in \mathbb{Z}_{N^2}}\mathbb{E}(X_c)\\&= \sum_{c\in \mathbb{Z}_{N^2}}\left(1-\frac{\binom{N^2-N}{N}}{\binom{N^2}{N}}\right)\\&=N ^2\left(1-\frac{\binom{N^2-N}{N}}{\binom{N^2}{N}}\right)\end{aligned}$$
所以实际上我们只需要证明$$1-\frac{\binom{N^2-N}{N}}{\binom{N^2}{N}}>\frac{1}{2}$$换言之我们只需要证明$$\prod_{k=1}^N \left(1-\frac{N}{N^2-N+k}\right)<\frac{1}{2}$$这实际上并不困难，只需要利用逐项估计的方法，使得当$N>1$的时候$$\begin{aligned}\prod_{k=1}^N \left(1-\frac{N}{N^2-N+k}\right)&=\prod_{k=1}^N \left(1-\frac{1}{N-1+\frac{k}{N}}\right)\\&\leq \prod_{k=1}^N \left(1-\frac{1}{N}\right)\\&=\left(1-\frac{1}{N}\right)^N\\&= e^{N\log(1-\frac{1}{N})}< e^{-1}<\frac{1}{2}\end{aligned}$$
因此，由于$\mathbb{E}(X)>\frac{N^2}{2}$所以一定存在$B\in P_N$使得$$X(B)=|A+B|>\frac{N^2}{2}$$






