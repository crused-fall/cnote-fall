---
tags:
  - math
  - tool_idea
---

> [!基本想法]
> 当我们处理某个部分和$S_N$的时候，如果我们发现被求和对象可以写成乘积的形式以至于部分和$S_N$可以写成$$S_N:=\sum_{n\leq N} a_nb_n$$并且我们假设其中$a_n,b_n$满足假设:
> 1. 其中形式较为简单的对象$a_n$起差分序列$a_{n+1}-a_n$是较为简单的。
> 2. 其中$b_n$的形式虽然较为复杂，但是其部分和$B_N:=\sum_{n\leq N}b_n$对我们而言是熟悉的(通过其他方式获取到的)
> 
> 此时我们可以借助部分和$B_N$以及差分$a_{n+1}-a_n$的估计来间接地得到$S_N$的估计。

首先什么是分部求和?
### 1. 离散版本的分部求和

主要是处理形如$\sum_n a_n b_n$这样的级数，或者$\sum_n a_n(z)b_n(z)$这样的函数项级数的估计，例如判断是否收敛。

我们先从一个简单的例子开始。

求$\sum_{k=1}^{n}k2^k$,这个问题当中一种观点是可以把$k$视为是一个求和，然后交换，基本思想参考[[和以及积分换序]]。

$$\begin{aligned}\sum_{k\leq n}k2^k&=\sum_{k\leq n}2^k\sum_{i\leq k}1 \\ &=\sum_{i\leq n}\sum_{k\leq n}2^k\chi_{i\leq k} \\ &= \sum_{i\leq n}\sum_{i\leq k\leq n}2^k \\ &= \sum_{i\leq n} \left(2^{n+1}-2^{i}\right) \\ &=n2^{n+1}-2^{n+1}+2 \end{aligned}$$
这根本上是分部求和法。我们不妨把上述过程给一般化，假设我们要求$A_n = \sum_{k\leq n} a_k b_k$,然后假设$b_n$的前n项和为$S_n$,然后假设$a_k = \sum_{i\leq k} c_i$,于是我们重复上述过程:
$$\begin{aligned}\sum_{k\leq n}a_kb_k&=\sum_{k\leq n}b_k\sum_{i\leq k}c_i \\ &=\sum_{i\leq n}\sum_{k\leq n}c_ib_k1_{i\leq k} \\ &= \sum_{i\leq n}c_i\sum_{i\leq k\leq n}b_k \\ &= \sum_{i\leq n}c_i \left(S_n-S_{i-1}\right) \\ &=a_nS_{n}-\sum_{i\leq n}c_iS_{i-1} \\ &= a_nS_{n}-\sum_{i\leq n-1}c_{i+1}S_{i}\end{aligned}$$其中我们能看到$c_{i+1}$是$a_{i+1}-a_i$也就是差分，$S_i$是$b_i$的前n项和，因此这本质上就是分部求和法。

如果我们把这个过程抽象一下，就得到如下的推导:
$$\begin{aligned}S_N:=\sum_{n=1}^{N}a_nb_n &=
a_1b_1+\sum_{n=2}^{N}a_n(B_{n}-B_{n-1}) \\&= a_1b_1+ a_N B_{N} -
a_2B_1 + \sum_{n=2}^{N-1} B_n(a_n-a_{n+1}) \\&= a_N B_{N}+\sum_{n=1}^{N-1} B_n(a_n-a_{n+1}) \end{aligned}$$

所以本质上来说，我们把对$S_N$的估计变成了对$$T_N:=\sum_{n=1}^{N-1} B_n(a_n-a_{n+1})$$的估计。此时，依照先前的假设，$B_N$的估计我们事先知道，差分$a_n-a_{n+1}$也是比较简单的，因此得到$T_N$的一个估计并不困难。

### 2. 一些应用

* [[已知序列的增长信息，以及算术平均值的信息，控制其p次幂的和]]当中为了完成估计任务：$$S_n:=\sum_{k\leq n}x_k^p=o(n^p)$$已知信息$x_k = o(k)$暗示我们可以进行分段估计，但是单纯的分段估计只能得到$o(n^{p+1})$的估计，达不到目标精度。不过问题当中还包含序列部分和$A_n:=\sum_{k\leq n}x_k$,并且已知$A_n<C$的信息，那么我们完全可以把$S_n$视为$x_kx_k^{p-1}$的和，其部分和既然是简单的，并且差分的上界也可以估计，那么在分段估计的后半段中利用分部求和应该就能提高估计精度。最后果然通过这种方法达到了想要的精度。特别要注意，考虑分部求和的时候，部分和要好处理，并且差分也必须是好处理的，否则估计精度会受到很大影响。

#### 2.1 Dirichlet定理及其推广

首先是一个特例：[[Leibniz收敛判断]]。其基本想法是来自于上面的方法。Leibniz的想法无非是对于$$S_N:=\sum_{n\leq N} (-1)^n a_n$$的和我们要得到至少为$o(1)$的精度的估计。我们知道$(-1)^n$的部分和$B_N$，这个和是比较简单的，无非就是在$-1,0$之间不断变化，是一个有界的序列。其次，虽然$a_n$是抽象的，但是Leibniz假设其具有单调性，从而$T_N:=\sum_{n=1}^{N-1} B_n(a_n-a_{n+1})$是一个绝对收敛的级数的部分和。因此真正左右$S_N$整个估计的精度是否能达到$o(1)$的部分只有$a_N B_{N}$这一项，那么由于$B_N$的有界性，我们只需要保证$a_n=o(1)$即可。

参照这一想法，Abel,Dirichlet也对$a_n,b_n$提出了条件得到了级数收敛，含参数级数的一致收敛的Abel-Dirichlet判别法。然而我们一旦发现了本质以后，我们在使用这些结果的时候就不会局限于那些假设条件，而是可以更为灵活自由地使用。下面是两个调整：

* [[对Dirichlet判别的一个调整]] 典型地通过分部求和法来开发的收敛判别法，其中文章里面对Dirichlet判别做了一个调整，以适应有时候单调性可能不存在，本质上也是利用了分部求和的想法。
* [[分部求和的想法，Dirichlet-Abel收敛判别法的推广]]当中同样利用分部求和的思想对经典的Dirichlet-Abel收敛判别做了推广，其中去掉了对$\sum_n a_n b_n$其中$b_n$序列的部分和有界，或者$b_n$对应的级数收敛的要求，而是扩展为做对$b_n$的部分和做估计。至于说这个部分和什么时候是合适的，这个要视$a_n$的差分的估计而定。
* [[Euler-Maclaurin求和公式在和的估计当中的应用]]这也是一个类似的问题，我们需要判断$$\sum_{n\geq }\frac{\sin(\sqrt{n})}{n}$$是否收敛。那么我们只需要估计$$S_N:=\sum_{n\leq N}\sin(\sqrt{n})$$其积分并不算困难，但是不具备单调性，因此决定采用Euler-Maclaurin做更细致的估计。
* [[已知序列模1均匀分布，那么加上log(n)对分布影响不大]]当中我们已知$$\sum_{n\leq N}e(kx_n)=o_k(N)$$我们需要判断是否$$\sum_{n\leq N}e(kx_n+k\log(n))=o_k(N)$$基于Weyl判别。然后我们观察到$e(kx_n+k\log(n))=e(kx_n)e(k\log(n))$这样一个结构，于是我们考虑是否可以用分部求和做估计。我们还要保证差分的估计，这部分主要是基于$$|e^{ix}-e^{iy}|\leq |x-y|$$最后我们得到$$|e(k\log(n+1))-e(k\log(n))|<2k\pi\log(1+1/n)=O_k\left(\frac{1}{n}\right)$$于是这便满足了我们对基于分部求和的估计的全部要求。

> [!上面的基本想法]
> 当$a_n$有着更强更好的性质的时候，我们同时就可以放松对$b_n$的部分和的要求。

> [!一个技巧]
> 此外我们要注意，$a_n$的简单不仅仅局限于其表达式的简单，如果其拥有单调性，那么我们比较容易知道其衰减到0的速度，即$a_n$的渐近表达，那么即便$a_n$的表达式复杂，也可以被算作是差分形式简单的。

比如下面这个例子：
* [[一个交错的双重级数的级数的收敛性判别]]：这个问题中我们需要证明$$\sum_{n\geq 1}\sum_{k\geq 1}\frac{(-1)^{\lfloor\sqrt{n}\rfloor}}{n^2+k^2}$$的收敛性。这个双重级数的问题只要我们稍加转换，这就可以是一个可以基于分部求和的估计问题。我们可以把问题转换为$$S_N:=\sum_{n\leq N}(-1)^{\lfloor\sqrt{n}\rfloor}\sum_{k\geq 1}\frac{1}{n^2+k^2}$$那么由于$(-1)^{\lfloor\sqrt{n}\rfloor}$的部分和对我们而言是一个熟悉的对象（参考[[分部求和的想法，Dirichlet-Abel收敛判别法的推广]]当中的例子3）。而$\sum_{k\geq 1}\frac{1}{n^2+k^2}$之所以被认为是一个较为简单的对象，因为它从上方单调收敛到0，通过简单的积分估计，我们不难看出来$\sum_{k\geq 1}\frac{1}{n^2+k^2}=O(1/n)$那么实际上我们等价于处理$\sum_{n\leq N}\frac{(-1)^{\lfloor\sqrt{n}\rfloor}}{n}$的估计。因为假设我们设$A_N:=\sum_{n\leq N}(-1)^{\lfloor\sqrt{n}\rfloor}$,$\sum_{k\geq 1}\frac{1}{n^2+k^2}=b_n$那么最重要估计的无非是$$b_NA_N+\sum_{n=1}^{N-1} A_n(b_n-b_{n+1})$$




